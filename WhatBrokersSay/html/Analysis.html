
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Analysis</title>
      <meta name="generator" content="MATLAB 7.6">
      <meta name="date" content="2009-05-21">
      <meta name="m-file" content="Analysis"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">WHAT BROKERS SAY</a></li>
               <li><a href="#2">Remove Table</a></li>
               <li><a href="#3">Each Row</a></li>
               <li><a href="#4">Each Column</a></li>
               <li><a href="#5">Columns</a></li>
            </ul>
         </div>
         <h2>WHAT BROKERS SAY<a name="1"></a></h2><pre class="codeinput">clear <span class="string">all</span>
close <span class="string">all</span>
s = urlread(<span class="string">'http://www.digitallook.com/dlmedia/investing/uk_shares/broker_views?username=bryantaylor&amp;ac=212439'</span>);
</pre><h2>Remove Table<a name="2"></a></h2><pre class="codeinput">n = findstr(s,<span class="string">'&lt;table border="0" cellspacing="0" width="100%" class="dl textRegular"&gt;'</span>);
y = findstr(s,<span class="string">'&lt;/table&gt;'</span>);
table = s(n:y+8);
</pre><h2>Each Row<a name="3"></a></h2><pre class="codeinput">start = findstr(table,<span class="string">'&lt;tr&gt;'</span>);
endof = findstr(table,<span class="string">'&lt;/tr&gt;'</span>);
[x] = size(start,2);
Headings = table(start(1):endof(1));
<span class="keyword">for</span> i = 2:x
    ROW{i-1,1} = table(start(i):endof(i));
<span class="keyword">end</span>
</pre><h2>Each Column<a name="4"></a></h2><pre class="codeinput">[x] = size(ROW,1);
<span class="keyword">for</span> i = 1:x
    text = ROW{i,1};

    <span class="comment">%Date</span>
    StartString = <span class="string">'&lt;td class="dataRegularUlOn dataRegularU1DateCell"&gt;&lt;div class=''dataRegularU1DateCell''&gt;'</span>;
    DateStart = findstr(text,StartString);
    DateEnd = findstr(text,<span class="string">'&lt;/div&gt;&lt;/td&gt;'</span>);
    Date = text(DateStart+size(StartString,2):DateEnd-1);
    <span class="keyword">if</span> isempty(Date)
    StartString = <span class="string">'&lt;td class="dataRegularUlOff dataRegularU1DateCell"&gt;&lt;div class=''dataRegularU1DateCell''&gt;'</span>;
    DateStart = findstr(text,StartString);
    DateEnd = findstr(text,<span class="string">'&lt;/div&gt;&lt;/td&gt;'</span>);
    Date = text(DateStart+size(StartString,2):DateEnd-1);
    <span class="keyword">end</span>
    Dates(i,1) = datenum(Date);

    <span class="comment">%CompanyName</span>
    StartString = <span class="string">'"&gt;'</span>;
    Start = findstr(text,StartString);
    DateEnd = findstr(text,<span class="string">'&lt;/td&gt;'</span>);

    [y] = size(DateEnd,2);
    <span class="keyword">for</span> j = 1:y
        Temp{i,j} = strrep(text(Start(j+1)+2:DateEnd(j)-1),<span class="string">'&lt;/a&gt;'</span>,<span class="string">''</span>);
    <span class="keyword">end</span>
<span class="keyword">end</span>
Temp = Temp(:,2:end);
<span class="keyword">for</span> i = 5:7
Temp(:,i) = num2cell(str2double(strrep(Temp(:,i),<span class="string">'p'</span>,<span class="string">''</span>)));
<span class="keyword">end</span>
Temp = [num2cell(Dates),Temp];
</pre><h2>Columns<a name="5"></a></h2><pre class="codeinput">Header = {<span class="string">'Date'</span>,<span class="string">'Company Name'</span>,<span class="string">'Ticker'</span>,<span class="string">'Broker name'</span>,<span class="string">'Recommendation'</span>,<span class="string">'Price'</span>,<span class="string">'Old Price Target'</span>,<span class="string">'New price target'</span>,<span class="string">'Broker change'</span>};
Temp = [Header;Temp]
</pre><pre class="codeoutput">
Temp = 

  Columns 1 through 4

    'Date'      'Company Name'           'Ticker'    'Broker name'        
    [733914]              [1x28 char]    'SDIC'      'Panmure Gordon'     
    [733914]    'G4S'                    'GFS'                 [1x22 char]
    [733914]    'Mitchells &amp; Butlers'    'MAB'       'Panmure Gordon'     
    [733914]    'Mitchells &amp; Butlers'    'MAB'       'Charles Stanley'    
    [733914]    'Tertiary Minerals'      'TYM'       'Seymour Pierce'     
    [733914]    'Topps Tiles'            'TPT'       'Altium Capital'     
    [733914]    'Leeds Group'            'LDSG'      'Seymour Pierce'     
    [733914]    'Intec Telecom'          'ITL'       'Panmure Gordon'     
    [733914]    'Headlam Group'          'HEAD'      'Altium Capital'     
    [733914]    'ICAP'                   'IAP'       'Numis'              
    [733914]    'Carpetright'            'CPR'       'Altium Capital'     
    [733914]    'Chloride Group'         'CHLD'      'Seymour Pierce'     
    [733914]    'Taylor Wimpey'          'TW.'       'CSFB'               
    [733914]    'Sage Group'             'SGE'       'Panmure Gordon'     
    [733914]    'Persimmon'              'PSN'       'CSFB'               
    [733914]    'Dairy Crest Group'      'DCG'                 [1x22 char]
    [733914]              [1x20 char]    'BDEV'      'CSFB'               
    [733914]              [1x21 char]    'MKS'       'Deutsche'           
    [733914]              [1x21 char]    'MKS'       'Exane BNP'          
    [733914]              [1x21 char]    'MKS'       'JP Morgan'          
    [733914]              [1x21 char]    'MKS'       'Bernstein'          
    [733914]    'AstraZeneca'            'AZN'       'Panmure Gordon'     
    [733913]    'Mitchells &amp; Butlers'    'MAB'       'Seymour Pierce'     
    [733913]    'Mitchells &amp; Butlers'    'MAB'       'CSFB'               
    [733913]    'Sage Group'             'SGE'       'Panmure Gordon'     
    [733913]    'StepStone ASA (DI)'     'STPS'      'Panmure Gordon'     
    [733913]    'Melorio'                'MLO'       'Daniel Stewart'     
    [733913]              [1x26 char]    'ATPT'      'Panmure Gordon'     
    [733913]    'Debenhams'              'DEB'                 [1x22 char]
    [733913]    'Standard Life'          'SL.'       'Cazenove'           
    [733913]    'Carluccio's'            'CARL'      'Seymour Pierce'     
    [733913]              [1x29 char]    'IHG'       'Panmure Gordon'     
    [733913]    'ARC International'      'ARK'       'Panmure Gordon'     
    [733913]    'Workspace Group'        'WKP'       'Panmure Gordon'     
    [733913]    'Fidessa'                'FDSA'      'Panmure Gordon'     
    [733913]    'Communisis'             'CMS'       'Panmure Gordon'     
    [733913]    'JD Sports Fashion'      'JD.'       'Seymour Pierce'     
    [733913]    'Marston's'              'MARS'      'CSFB'               
    [733913]    'Trafficmaster'          'TFC'       'Panmure Gordon'     
    [733913]    'Mothercare'             'MTC'       'Seymour Pierce'     
    [733913]    'JD Wetherspoon'         'JDW'       'CSFB'               
    [733913]    'Greene King'            'GNK'       'CSFB'               
    [733913]    'Enterprise Inns'        'ETI'       'CSFB'               
    [733913]    'De La Rue'              'DLAR'      'Panmure Gordon'     
    [733913]    'Cookson Group'          'CKSN'      'Citigroup'          
    [733913]    'RSA Insurance Group'    'RSA'       'JP Morgan'          
    [733913]              [1x20 char]    'LLOY'      'Exane BNP'          
    [733913]              [1x20 char]    'LLOY'      'Societe Generale'   
    [733913]              [1x28 char]    'DMGT'      'Investec Securities'
    [733913]    'Barclays'               'BARC'      'Collins Stewart'    

  Columns 5 through 8

    'Recommendation'    'Price'       'Old Price Target'    'New price target'
    'Buy'               [ 22.2500]    [             NaN]    [             NaN]
    'Buy'               [     218]    [             NaN]    [             NaN]
    'Hold'              [237.7500]    [             260]    [             NaN]
    'Buy'               [237.7500]    [             310]    [             325]
    'Buy'               [  2.7500]    [             NaN]    [             NaN]
    'Sell'              [      68]    [              34]    [             NaN]
    'Buy'               [ 14.2500]    [             NaN]    [             NaN]
    'Buy'               [ 52.7500]    [              50]    [              56]
    'Hold'              [     250]    [             NaN]    [             259]
    'Hold'              [367.2500]    [             NaN]    [             NaN]
    'Sell'              [     619]    [             315]    [             NaN]
    'Sell'              [154.5000]    [             NaN]    [             NaN]
    'Outperform'        [ 33.2500]    [             NaN]    [             NaN]
...</pre><p class="footer"><br>
            Published with MATLAB&reg; 7.6<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% WHAT BROKERS SAY
clear all
close all
s = urlread('http://www.digitallook.com/dlmedia/investing/uk_shares/broker_views?username=bryantaylor&ac=212439');

%% Remove Table
n = findstr(s,'<table border="0" cellspacing="0" width="100%" class="dl textRegular">');
y = findstr(s,'</table>');
table = s(n:y+8);

%% Each Row
start = findstr(table,'<tr>');
endof = findstr(table,'</tr>');
[x] = size(start,2);
Headings = table(start(1):endof(1));
for i = 2:x
    ROW{i-1,1} = table(start(i):endof(i));
end

%% Each Column
[x] = size(ROW,1);
for i = 1:x
    text = ROW{i,1};
    
    %Date
    StartString = '<td class="dataRegularUlOn dataRegularU1DateCell"><div class=''dataRegularU1DateCell''>';
    DateStart = findstr(text,StartString);
    DateEnd = findstr(text,'</div></td>');
    Date = text(DateStart+size(StartString,2):DateEnd-1);
    if isempty(Date)
    StartString = '<td class="dataRegularUlOff dataRegularU1DateCell"><div class=''dataRegularU1DateCell''>';
    DateStart = findstr(text,StartString);
    DateEnd = findstr(text,'</div></td>');
    Date = text(DateStart+size(StartString,2):DateEnd-1);           
    end
    Dates(i,1) = datenum(Date);
    
    %CompanyName
    StartString = '">';
    Start = findstr(text,StartString);
    DateEnd = findstr(text,'</td>');
    
    [y] = size(DateEnd,2);
    for j = 1:y
        Temp{i,j} = strrep(text(Start(j+1)+2:DateEnd(j)-1),'</a>','');
    end   
end
Temp = Temp(:,2:end);
for i = 5:7
Temp(:,i) = num2cell(str2double(strrep(Temp(:,i),'p','')));
end
Temp = [num2cell(Dates),Temp];

%% Columns
Header = {'Date','Company Name','Ticker','Broker name','Recommendation','Price','Old Price Target','New price target','Broker change'};
Temp = [Header;Temp]
##### SOURCE END #####
-->
   </body>
</html>